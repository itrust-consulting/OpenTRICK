<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<!-- Generated Jan 25, 2013 10:16:34 AM by Hibernate Tools 3.4.0.CR1 -->
<hibernate-mapping package="lu.itrust.business.TS">
	<class name="Analysis" table="Analysis">
		<id column="idAnalysis" name="id" unsaved-value="-1">
			<generator class="increment" />
		</id>

		<properties name="index_unique" unique="true">
			<property length="23" type="string" column="dtIdentifier" generated="never" lazy="false" name="identifier" not-null="true" />
			<property length="12" type="string" column="dtVersion" generated="never" lazy="false" name="version" not-null="true" />
			<property type="timestamp" column="dtCreationDate" generated="never" lazy="false" name="creationDate" not-null="true" />
		</properties>
		
		<property name="profile" column="dtProfile" access="field" not-null="true"/>

		<many-to-one class="Customer" column="fiCustomer" name="customer" not-null="true" lazy="false" access="field" />

		<many-to-one class="Language" column="fiLanguage" name="language" not-null="true" lazy="false" access="field" />

		<many-to-one name="basedOnAnalysis" class="Analysis" not-null="false" cascade="save-update">
			<column name="fiBasedOnAnalysis" />
		</many-to-one>

		<many-to-one name="owner" class="lu.itrust.business.TS.usermanagement.User">
			<column name="fiOwner" not-null="true" />
		</many-to-one>

		<property length="255" type="string" column="dtLabel" generated="never" lazy="false" not-null="true" name="label" access="field" />

		<property column="dtData" generated="never" lazy="false" name="data" not-null="true" />

		<bag name="histories" table="history" cascade="all">
			<key column="fiAnalysis" not-null="true" />
			<one-to-many class="History" />
		</bag>

		<bag name="riskInformations" table="RiskInformation" cascade="all" access="field">
			<key column="fiAnalysis" not-null="true" />
			<one-to-many class="RiskInformation" />
		</bag>

		<bag name="itemInformations" table="ItemInformation" cascade="all" access="field">
			<key column="fiAnalysis" not-null="true" />
			<one-to-many class="ItemInformation" />
		</bag>

		<bag name="riskRegisters" table="RiskRegister" cascade="all" access="field">
			<key column="fiAnalysis" not-null="true" />
			<one-to-many class="lu.itrust.business.TS.cssf.RiskRegisterItem" />
		</bag>

		<bag name="summaries" table="ActionPlanSummary" cascade="all" access="field">
			<key column="fiAnalysis" not-null="true" />
			<one-to-many class="lu.itrust.business.TS.actionplan.SummaryStage" />
		</bag>

		<bag name="actionPlans" table="Actionplan" cascade="all" access="field" order-by="id, (measure.phase.number) ASC, ROI ASC">
			<key column="fiAnalysis" not-null="true" />
			<one-to-many class="lu.itrust.business.TS.actionplan.ActionPlanEntry" />
		</bag>

		<bag name="assessments" table="Assessment" cascade="all" access="field">
			<key column="fiAnalysis" not-null="true" />
			<one-to-many class="Assessment" />
		</bag>

		<bag name="scenarios" table="Scenario" cascade="all" access="field" order-by="(type.type) asc, name asc">
			<key column="fiAnalysis" not-null="true" />
			<one-to-many class="Scenario" />
		</bag>

		<bag name="analysisNorms" table="AnalysisNorm" cascade="all" inverse="true" access="field" order-by="norm.id asc">
			<key column="fiAnalysis" not-null="true" />
			<one-to-many class="AnalysisNorm"/>
		</bag>

		<bag name="usedPhases" table="Phase" cascade="all" inverse="true" access="field" lazy="false" order-by="number asc">
			<key column="fiAnalysis" not-null="true" />
			<one-to-many class="Phase" />
		</bag>

		<bag name="parameters" table="Parameter" cascade="all" access="field">
			<key column="fiAnalysis" not-null="true" />
			<one-to-many class="Parameter" />
		</bag>

		<bag name="assets" table="Asset" cascade="all" access="field" order-by="value desc, ALE desc , name asc">
			<key column="fiAnalysis" not-null="true" />
			<one-to-many class="Asset" />
		</bag>

		<bag name="userRights" table="UserAnalysisRight" cascade="all" access="field" inverse="true">
			<key column="fiAnalysis" not-null="true" />
			<one-to-many class="UserAnalysisRight" />
		</bag>

	</class>

	<class name="lu.itrust.business.TS.UserAnalysisRight" table="UserAnalysisRight">
		<id column="idUserAnalysisRight" name="id" unsaved-value="-1">
			<generator class="increment" />
		</id>
		<properties name="unique_index" unique="true">
			<many-to-one name="user" column="fiUser" not-null="true" cascade="save-update" />
			<many-to-one name="analysis" column="fiAnalysis" not-null="true" cascade="save-update" />
		</properties>
		<property generated="never" lazy="false" name="right">
			<column name="dtRight" />
			<type name="org.hibernate.type.EnumType">
				<param name="type">12</param>
				<param name="useNamed">true</param>
				<param name="enumClass">lu.itrust.business.TS.AnalysisRight</param>
			</type>
		</property>
	</class>

</hibernate-mapping>
