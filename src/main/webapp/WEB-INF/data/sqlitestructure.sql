 
 -- TABLES Please Update database version current : 2.4 
CREATE TABLE `identifier` ( `id_analysis` VARCHAR(23) NOT NULL  UNIQUE ,`label` VARCHAR(255) NOT NULL UNIQUE, `version` VARCHAR(23) NOT NULL DEFAULT '2.4' , `analysis_type` VARCHAR(23) DEFAULT `QUANTITATIVE`, `uncertainty` BOOL DEFAULT false, PRIMARY KEY (`id_analysis`, `label`))
CREATE TABLE assessment (id_asset INTEGER NOT NULL, id_threat INTEGER NOT NULL, selected TEXT DEFAULT '', impact_hidden DOUBLE NOT NULL DEFAULT 0, potentiality TEXT NOT NULL DEFAULT 'i', potentiality_hidden DOUBLE NOT NULL DEFAULT 0, comment TEXT DEFAULT '', comment_2 TEXT DEFAULT '', owner TEXT DEFAULT '', total_ALE DOUBLE NOT NULL DEFAULT 0 , `uncertainty` DOUBLE DEFAULT 2, PRIMARY KEY (`id_threat`, `id_asset`));
CREATE TABLE asset_types (id_type_asset INTEGER PRIMARY KEY NOT NULL, name_type_asset TEXT NOT NULL DEFAULT '');
CREATE TABLE assets (id_asset INTEGER PRIMARY KEY NOT NULL, name_asset TEXT NOT NULL DEFAULT '', id_type_asset INTEGER NOT NULL, value_asset DOUBLE DEFAULT 0, comment_asset TEXT DEFAULT '', comment_asset_2 TEXT DEFAULT '', sel_asset TEXT DEFAULT 'x', total_ALE DOUBLE DEFAULT 0);
CREATE TABLE history (id_version TEXT PRIMARY KEY  NOT NULL , date TEXT NOT NULL  DEFAULT CURRENT_DATE, author TEXT NOT NULL DEFAULT '', comment TEXT DEFAULT '');
CREATE TABLE impact (id_impact INTEGER PRIMARY KEY NOT NULL,`type` VARCHAR(255),scale_impact INTEGER DEFAULT 0,`label_impact` VARCHAR(255) DEFAULT '', name_impact TEXT DEFAULT '', acro_impact TEXT DEFAULT '', value_impact DOUBLE DEFAULT 0, value_from_impact DOUBLE DEFAULT 0, value_to_impact DOUBLE DEFAULT 0);
CREATE TABLE info_phases (num_phase INTEGER PRIMARY KEY NOT NULL, begin_date TEXT, end_date TEXT);
CREATE TABLE maturities (version_norme int(11) NOT NULL, norme_description TEXT NOT NULL, norme_computable tinyint(1) NOT NULL, ref TEXT NOT NULL , measure_computable tinyint(1) NOT NULL,domain TEXT DEFAULT '', phase int(11) NOT NULL DEFAULT 0, level INTEGER DEFAULT 1 ,status TEXT DEFAULT 'AP' ,rate DOUBLE DEFAULT 0 ,intwl double DEFAULT 0 ,extwl double DEFAULT 0 ,investment double DEFAULT 0,lifetime double DEFAULT 5 ,internal_maintenance double DEFAULT 0, external_maintenance double DEFAULT 0, recurrent_investment double DEFAULT 0 ,comment text DEFAULT '' ,todo text DEFAULT '', responsible VARCHAR DEFAULT '',sml1 double DEFAULT 0 ,sml2 double DEFAULT 0 ,sml3 double DEFAULT 0 ,sml4 double DEFAULT 0 ,sml5 double DEFAULT 0 ,index2 double, reached INT);
CREATE TABLE maturity_IS (line INT,value DOUBLE);
CREATE TABLE maturity_max_eff (col INT,value DOUBLE);
CREATE TABLE maturity_required_LIPS (name TEXT DEFAULT ('') ,line INT,SML INT,value DOUBLE);
CREATE TABLE measures (id_norme TEXT NOT NULL , version_norme int(11) NOT NULL, norme_description TEXT NOT NULL,norme_type varchar(255) NOT NULL, norme_computable tinyint(1) NOT NULL, norme_analysisOnly tinyint(1) NOT NULL, ref_measure TEXT NOT NULL, measure_computable tinyint(1) NOT NULL, domain_measure TEXT DEFAULT '', question_measure TEXT DEFAULT '', level INTEGER DEFAULT 1, strength_measure DOUBLE DEFAULT 0 ,strength_sectoral DOUBLE DEFAULT 0 ,confidentiality DOUBLE DEFAULT 0 ,integrity DOUBLE DEFAULT 0 ,availability DOUBLE DEFAULT 0, exploitability DOUBLE DEFAULT 0, reliability DOUBLE DEFAULT 0, d1 INTEGER, d2 INTEGER, d3 INTEGER, d4 INTEGER, d5 INTEGER, d6 INTEGER, d61 INTEGER, d62 INTEGER, d63 INTEGER, d64 INTEGER, d7 INTEGER, i1 INTEGER, i2 INTEGER, i3 INTEGER, i4 INTEGER, i5 INTEGER, i6 INTEGER, i7 INTEGER, i8 INTEGER, i81 INTEGER, i82 INTEGER, i83 INTEGER, i84 INTEGER, i9 INTEGER, i10 INTEGER, preventive DOUBLE DEFAULT 0 ,detective DOUBLE DEFAULT 0 ,limiting DOUBLE DEFAULT 0 ,corrective DOUBLE DEFAULT 0 ,intentional DOUBLE DEFAULT 0 ,accidental DOUBLE DEFAULT 0 ,environmental DOUBLE DEFAULT 0 ,internal_threat DOUBLE DEFAULT 0 ,external_threat DOUBLE DEFAULT 0 ,internal_setup DOUBLE DEFAULT 0 ,external_setup DOUBLE DEFAULT 0 ,investisment DOUBLE DEFAULT 0 ,lifetime DOUBLE DEFAULT 0 , internal_maintenance double DEFAULT 0, external_maintenance double DEFAULT 0, recurrent_investment double DEFAULT 0 ,implementation_rate DOUBLE DEFAULT 0 ,status TEXT DEFAULT 'AP' ,comment TEXT DEFAULT '',todo TEXT DEFAULT '', revision TEXT DEFAULT '' , responsible VARCHAR DEFAULT '' , phase integer DEFAULT 1, soa_reference TEXT DEFAULT '', soa_risk TEXT DEFAULT '', soa_comment TEXT DEFAULT '',index2 DOUBLE DEFAULT (0) )
CREATE TABLE organisation (processus_development TEXT DEFAULT '', stakeholder_identification TEXT DEFAULT '', role_responsability TEXT DEFAULT '', stakeholder_relation TEXT DEFAULT '', escalation_way TEXT DEFAULT '', document_conserve TEXT DEFAULT '');
CREATE TABLE phase (id_norme TEXT NOT NULL DEFAULT '', ref_measure TEXT NOT NULL DEFAULT '', phase INTEGER DEFAULT 1);
CREATE TABLE potentiality (id_potentiality INTEGER PRIMARY KEY NOT NULL, scale_potentiality INTEGER DEFAULT 0,`label_potentiality` VARCHAR(255) DEFAULT '', name_potentiality TEXT DEFAULT '', acro_potentiality TEXT DEFAULT '',  value_potentiality DOUBLE DEFAULT 0, value_from_potentiality DOUBLE DEFAULT 0, value_to_potentiality DOUBLE DEFAULT 0);
CREATE TABLE scope (type_organism TEXT DEFAULT '', type_profit_organism TEXT DEFAULT '', name_organism TEXT DEFAULT '', presentation_organism TEXT DEFAULT '', sector_organism TEXT DEFAULT '', composants_organism TEXT DEFAULT '', key_information_organism TEXT DEFAULT '', security_requirement_organism TEXT DEFAULT '', internal_setup_rate DOUBLE DEFAULT 800, external_setup_rate DOUBLE DEFAULT 1200, max_rrf TEXT DEFAULT 100, responsible_organism TEXT NOT NULL DEFAULT '', staff_organism TEXT DEFAULT '', activities_organism TEXT DEFAULT '', excluded_assets TEXT DEFAULT '', occupation TEXT  DEFAULT '', functional TEXT  DEFAULT '', juridic TEXT  DEFAULT '', pol_organisation TEXT  DEFAULT '', management_organisation TEXT  DEFAULT '', premises TEXT  DEFAULT '', requirements TEXT  DEFAULT '', expectations TEXT  DEFAULT '', environment TEXT  DEFAULT '', interface TEXT DEFAULT '', lifetime_default DOUBLE DEFAULT 5, strategic TEXT DEFAULT 'Defined by law (see Legal aspects)', soaThreshold DOUBLE DEFAULT 100, mandatoryPhase INTEGER DEFAULT 0,financialParameters TEXT DEFAULT ('') ,riskEvaluationCriteria TEXT DEFAULT ('') ,impactCriteria TEXT DEFAULT ('') ,riskAcceptanceCriteria TEXT DEFAULT (''), cssfImpactThreshold DOUBLE DEFAULT 5, cssfProbabilityThreshold DOUBLE DEFAULT 6, cssfDirectSize DOUBLE DEFAULT 20, cssfIndirectSize DOUBLE DEFAULT 5, cssfCIASize DOUBLE DEFAULT -1, dynamic_parameter_timespan INTEGER DEFAULT 0);
CREATE TABLE spec_default_type_asset_measure (id_type_asset integer NOT NULL , id_norme TEXT NOT NULL, version_norme int(11) NOT NULL, ref_measure TEXT NOT NULL , value_spec DOUBLE DEFAULT -1 );
CREATE TABLE spec_type_asset_measure (id_type_asset INTEGER NOT NULL , id_norme TEXT NOT NULL,version_norme int(11) NOT NULL, ref_measure TEXT NOT NULL , value_spec DOUBLE DEFAULT 100 );
CREATE TABLE spec_asset_measure (id_asset integer NOT NULL , id_norme TEXT NOT NULL,version_norme int(11) NOT NULL, ref_measure TEXT NOT NULL , value_spec DOUBLE DEFAULT 100 );
CREATE TABLE threat_typology (level VARCHAR(5) NOT NULL,name VARCHAR(255),acro VARCHAR(15) DEFAULT '',expo VARCHAR(2) DEFAULT'=',`owner` VARCHAR(255) DEFAULT '',comment TEXT DEFAULT '',comment2 TEXT DEFAULT '');
CREATE TABLE threat_source (level varchar(5) NOT NULL,name varchar(255),type VARCHAR(5),expo varchar(2) DEFAULT '=', `owner` VARCHAR(255) DEFAULT '',comment TEXT DEFAULT '',comment2 TEXT DEFAULT '');
CREATE TABLE threats (id_threat INTEGER PRIMARY KEY NOT NULL, name_threat TEXT, type_threat varchar(255), linked_asset_threat tinyint(1) DEFAULT FALSE, description_threat TEXT, sel_threat TEXT, serv INTEGER, info INTEGER, sw INTEGER, hw INTEGER, net INTEGER, staff INTEGER, iv INTEGER, busi INTEGER, fin INTEGER, compl INTEGER, confidentiality INTEGER, integrity INTEGER, availability INTEGER, exploitability INTEGER, reliability INTEGER, d1 INTEGER, d2 INTEGER, d3 INTEGER, d4 INTEGER, d5 INTEGER, d6 INTEGER, d61 INTEGER, d62 INTEGER, d63 INTEGER, d64 INTEGER, d7 INTEGER, i1 INTEGER, i2 INTEGER, i3 INTEGER, i4 INTEGER, i5 INTEGER, i6 INTEGER, i7 INTEGER, i8 INTEGER, i81 INTEGER, i82 INTEGER, i83 INTEGER, i84 INTEGER, i9 INTEGER, i10 INTEGER, preventive DOUBLE, detective DOUBLE, limitative DOUBLE, corrective DOUBLE, intentional INTEGER, accidental INTEGER, environmental INTEGER, internal_threat INTEGER, external_threat INTEGER);
CREATE TABLE vulnerabilities (level VARCHAR(5) NOT NULL,name VARCHAR(255),expo VARCHAR(2) DEFAULT '=',`owner` VARCHAR(255) DEFAULT '',comment TEXT DEFAULT '',comment2 TEXT DEFAULT '');
CREATE TABLE ActionPlanType(`idActionPlanType` INTEGER PRIMARY KEY NOT NULL, `dtLabel` VARCHAR(255) NOT NULL);
CREATE TABLE ActionPlan(`idActionPlanCalculation` INTEGER PRIMARY KEY NOT NULL, `idActionPlanType` INTEGER NOT NULL, `norm` VARCHAR(13) NOT NULL,`idMeasure` VARCHAR(13) NOT NULL , `dtOrder` VARCHAR(5) NOT NULL DEFAULT '=', `dtCost` DOUBLE UNSIGNED NOT NULL, `dtROI` DOUBLE NOT NULL, `dtTotalALE` DOUBLE UNSIGNED NOT NULL, `dtDeltaALE` DOUBLE UNSIGNED NOT NULL);
CREATE TABLE ActionPlanAsset(`idActionPlanAssetCalculation` INTEGER PRIMARY KEY NOT NULL, `idActionPlanCalculation` INTEGER NOT NULL, `idActionPlanType` INT UNSIGNED NOT NULL,`idNorm` TEXT NOT NULL,`dtNormVersion` TEXT NOT NULL, `idMeasureActionPlan` INT UNSIGNED NOT NULL, `idAsset` INT UNSIGNED NOT NULL, `dtCurrentALE` DOUBLE UNSIGNED NOT NULL);
CREATE TABLE ActionPlanSummary(`idActionPlanSummary` INTEGER PRIMARY KEY NOT NULL, `idActionPlanType` INT UNSIGNED NOT NULL, `idName` VARCHAR(255) NOT NULL, `dt27001Conformance` DOUBLE UNSIGNED NOT NULL, `dt27002Conformance` DOUBLE UNSIGNED NOT NULL, `dtMeasureCount` DOUBLE UNSIGNED NOT NULL, `dtImplementedMeasureCount` INT UNSIGNED NOT NULL, `dtCurrentTotalALE` DOUBLE UNSIGNED NOT NULL, `dtCurrentDeltaALE` DOUBLE UNSIGNED NOT NULL, `dtCurrentCostMeasures` DOUBLE UNSIGNED NOT NULL, `dtROSI` DOUBLE NOT NULL, `dtRelativeROSI` DOUBLE NOT NULL, `dtTotalInternalWorkLoad` INT UNSIGNED NOT NULL, `dtTotalExternalWorkload` INT UNSIGNED NOT NULL, `dtInvestment` DOUBLE UNSIGNED NOT NULL, `dtTotalInternalMaintenance` DOUBLE UNSIGNED NOT NULL, `dtTotalExternalMaintenance` DOUBLE UNSIGNED NOT NULL, `dtRecurrentInvestment` DOUBLE UNSIGNED NOT NULL, `dtRecurrentCost` DOUBLE UNSIGNED NOT NULL, `dtTotalCost` DOUBLE UNSIGNED NOT NULL);
CREATE TABLE risk_register (id_threat INTEGER NOT NULL , id_asset INTEGER NOT NULL ,raw_evaluation_probability DOUBLE NOT NULL  DEFAULT (0) ,raw_evaluation_impact DOUBLE NOT NULL  DEFAULT (0) ,raw_evaluation_importance DOUBLE NOT NULL  DEFAULT (0) ,net_evaluation_probability DOUBLE NOT NULL  DEFAULT (0) ,net_evaluation_impact DOUBLE NOT NULL  DEFAULT (0) ,net_evaluation_importance DOUBLE NOT NULL  DEFAULT (0) ,expected_evaluation_probability DOUBLE NOT NULL  DEFAULT (0) ,expected_evaluation_impact DOUBLE NOT NULL  DEFAULT (0) ,expected_evaluation_importance DOUBLE NOT NULL  DEFAULT (0),PRIMARY KEY (`id_threat`,`id_asset`)); 
CREATE TABLE risk_profile (`id_threat` INTEGER NOT NULL , `id_asset` INTEGER NOT NULL, `actionPlan` TEXT,`treatment` TEXT, `strategy` VARCHAR, `exp_probability` VARCHAR, `raw_probability` VARCHAR, PRIMARY KEY (`id_threat`, `id_asset`));
CREATE TABLE risk_profile_impact (`id_threat` INTEGER NOT NULL , `id_asset` INTEGER NOT NULL,`name` VARCHAR(255), `value` VARCHAR(255), PRIMARY KEY (`id_threat`, `id_asset`,`name`,`value`));
CREATE TABLE risk_profile_measure (`id_threat` INTEGER NOT NULL , `id_asset` INTEGER NOT NULL,id_norme TEXT NOT NULL , version_norme int(11) NOT NULL,ref_measure TEXT NOT NULL);
CREATE TABLE dynamic_parameter (id_parameter INTEGER PRIMARY KEY NOT NULL, name_parameter TEXT DEFAULT '', acro_parameter TEXT DEFAULT '', value_parameter DOUBLE DEFAULT 0);
CREATE TABLE impact_type (`name` VARCHAR(255) PRIMARY KEY NOT NULL, `acronym` VARCHAR(255) NOT NULL,`translation` VARCHAR(255) NOT NULL,`shortName` VARCHAR(255) NOT NULL);
CREATE TABLE assessment_impacts ( `id_asset` INTEGER NOT NULL,`id_threat` INTEGER NOT NULL ,`name` VARCHAR(255), `value` DOUBLE, PRIMARY KEY (`id_threat`, `id_asset`,`name`));
CREATE TABLE risk_acceptance ( `label` VARCHAR(255) DEFAULT '',`level` INTEGER NOT NULL, `color` VARCHAR(255) DEFAULT '#fada91', `description` VARCHAR(255) DEFAULT '');
CREATE TABLE threat_assets ( id_threat INTEGER NOT NULL, id_asset INTEGER NOT NULL);
 -- INDEX CREATION
 
CREATE UNIQUE INDEX asset_types_index ON asset_types (id_type_asset);
CREATE UNIQUE INDEX assets_index ON assets (id_asset);
CREATE UNIQUE INDEX history_index ON history (id_version);
CREATE UNIQUE INDEX impact_index ON impact (id_impact);
CREATE UNIQUE INDEX potentiality_index ON potentiality (id_potentiality);
CREATE UNIQUE INDEX threats_index ON threats (id_threat);
 
 -- INSERTS
 
INSERT INTO scope (type_organism) VALUES ('')
INSERT INTO organisation (processus_development) VALUES ('')