<!DOCTYPE html>
<html lang="${#locale.language}" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{../template/header :: head(title='label.title.otp.signin')}"></head>
<body>
<div id="wrap">
    <div class="container">
        <img class="center-block" alt="#{label.logo}" th:src="@{/images/brand.png}" style="height: 200px;">
        
        <div class="form-signin" id="login" style="margin: 0 auto; max-width: 330px;">
            <div class="form-horizontal">
                <div class='form-group'>
                    <label th:text="#{label.otp.select.method}">Please select a method</label>
                    <select id='otp-option-method' required="required" class="form-control">
                        <option th:if="${application}" value="application" th:text="#{label.otp.use.application}">Use mobile application</option>
                        <option th:if="${email}" value="email" th:text="#{label.otp.send.email(${email})}">Send an email to ${email}</option>
                        <option th:if="${phoneNumber}" value="tel" th:text="#{label.otp.send.text(${phoneNumber})}">Send text to ${phoneNumber}</option>
                    </select>
                    <div th:if="${error}" class='label label-danger' th:text="#{${error}}">${error}</div>
                </div>

                <form th:if="${email}" name="application" th:action="@{/OTP/Authorise}" method="post" id="otp-option-application" th:attr="data-action-name=#{label.action.signin}">
                    <input type="hidden" name="otp-method" value="application"/>
                    <div class='form-group'>
                        <label th:text="#{label.otp.enter.application.code}">Please enter code</label>
                        <input name="otp-user-code" size="8" type="number" class="form-control" required="required" placeholder="000000000">
                    </div>
                    <input type="submit" id="application-form-submit" hidden="hidden"/>
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    <input type="hidden" name="username" th:value="${#authentication.name}"/>
                </form>

                <form th:if="${email}" name="email" th:action="@{/OTP/Generate-code}" method="get" class="form-horizontal" id="otp-option-email" th:attr="data-action-name=#{label.action.send.code}">
                    <input type="hidden" name="otp-method" value="email"/>
                    <div class='form-group'>
                        <label th:text="#{label.otp.enter.email}">Please enter your email</label>
                        <input name="otp-method-value" type="email" th:placeholder="${email}" class="form-control" required="required">
                    </div>
                    <input type="submit" id="application-email-submit" hidden="hidden"/>
                </form>

                <form th:if="${phoneNumber}" name="tel" th:action="@{/OTP/Generate-code}" method="get" class="form-horizontal" id="otp-option-tel" th:attr="data-action-name=#{label.action.send.code}">
                    <input type="hidden" name="otp-method" value="tel"/>
                    <div class='form-group'>
                        <label th:text="#{label.otp.enter.text}">Please enter your mobile phone</label>
                        <input name="otp-method-value" type="tel" th:placeholder="${phoneNumber}" required="required" class="form-control">
                    </div>
                    <input type="submit" id="application-email-submit" hidden="hidden"/>
                </form>

                <div class="form-group">
                    <button class="btn btn-danger pull-left" id='otp-option-submit' th:text="#{label.action.signin}">Sign In</button>
                    <a href="#" class="btn btn-default pull-right" onclick="return document.getElementById('logoutFormSubmiter').click()" th:text="#{label.action.cancel}">Cancel</a>
                </div>
            </div>

            <form th:action="@{/Signout}" method="post" style="display: none">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <input type="submit" id="logoutFormSubmiter" />
            </form>
        </div>
    </div>

    <div th:replace="~{../template/footer :: footer}"></div>
    <div th:replace="~{../template/scripts :: scripts}"></div>
</div>
</body>
</html>
